# 投注单交互系统任务执行指南

本文档说明如何使用 Manus AI 执行投注单交互系统的各个子任务。

**⚠️ 重要更新**: 任务完成后**直接合并到 main 分支**，不再创建 Pull Request 进行审核。

---

## 任务概览

| Issue ID | 任务名称 | 推荐模型 | 依赖任务 | 状态 |
| :--- | :--- | :--- | :--- | :--- |
| VOI-71 | 投注单基础框架与模式切换 | `manus-1.6-lite` | 无 | 待执行 |
| VOI-72 | 投注单状态管理与UI展示 | `manus-1.6-lite` | VOI-71 | 待执行 |
| VOI-73 | 投注生命周期与等待处理 | `manus-1.6-lite` | VOI-71, VOI-72 | 待执行 |
| VOI-74 | 投注拒绝与打回处理 | `manus-1.6-lite` | VOI-71, VOI-72, VOI-73 | 待执行 |
| VOI-75 | 高级过关功能 | `manus-1.6` | VOI-71, VOI-72 | 待执行 |

---

## 执行顺序

### 批次 1: 基础框架（可立即执行）
- **VOI-71**: 投注单基础框架与模式切换

### 批次 2: 并行执行（等待 VOI-71 完成）
- **VOI-72**: 投注单状态管理与UI展示
- **VOI-75**: 高级过关功能

### 批次 3: 顺序执行（等待 VOI-71 和 VOI-72 完成）
- **VOI-73**: 投注生命周期与等待处理
- **VOI-74**: 投注拒绝与打回处理（等待 VOI-73 完成）

---

## 如何执行任务

### 步骤 1: 准备提示词

每个任务都有对应的提示词文档：

```
docs/.knowledge/task_prompts/
├── VOI-71_prompt.md
├── VOI-72_prompt.md
├── VOI-73_prompt.md
├── VOI-74_prompt.md
└── VOI-75_prompt.md
```

### 步骤 2: 创建 Manus AI 对话

1. 打开 [Manus AI](https://manus.im)
2. 点击"新建对话"
3. 选择推荐的模型（见上表）
4. 复制对应任务的提示词
5. 粘贴到对话框并发送

### 步骤 3: 启用集成

确保在对话中启用以下集成：
- ✅ GitHub (用于克隆仓库、创建分支、提交代码、合并分支)
- ✅ Linear (用于更新 Issue 状态)

### 步骤 4: 监控执行

Agent 会自动执行以下步骤：
1. 克隆 GitHub 仓库
2. 创建并切换到指定分支
3. 阅读相关文档
4. 实现功能
5. 测试代码
6. 提交代码
7. **直接合并到 main 分支**（不创建 PR）
8. 更新 Linear Issue 状态

### 步骤 5: 验证结果

Agent 完成后：
1. 代码已自动合并到 main 分支
2. 在本地或部署环境测试功能
3. 如有问题，在对话中继续沟通修改
4. 确认功能正常后关闭 Issue

---

## 提示词使用示例

### 示例 1: 执行 VOI-71

```
# 在 Manus AI 中创建新对话

模型选择: manus-1.6-lite

提示词:
[复制 VOI-71_prompt.md 中的完整提示词内容]
```

### 示例 2: 执行 VOI-75（复杂任务）

```
# 在 Manus AI 中创建新对话

模型选择: manus-1.6 ⚠️ 注意使用标准模型

提示词:
[复制 VOI-75_prompt.md 中的完整提示词内容]
```

---
### 成本优化建议

根据最新的 **Manus API 成本节省原则**，我们对本项目中的模型选择进行了优化，以最大化性价比。

#### 模型选择原则

1.  **任务解耦优先**: 尽可能将复杂的大任务分解为多个独立的小任务。
2.  **为小任务使用轻量模型**: 对于解耦后的简单、独立的子任务（如数据提取、格式转换等），优先使用 `manus-1.6-lite` 模型，以最低的成本快速完成。
3.  **为整合任务使用标准模型**: 对于需要协调和整合多个子任务结果的“整合”型任务，使用 `manus-1.6` 模型，在成本和性能之间取得平衡。
4.  **为复杂任务保留旗舰模型**: 仅当任务极其复杂且无法有效解耦时，才使用 `manus-1.6-max` 模型。该模型能力最强，但成本也最高，应保留用于最关键、最困难的场景。

#### 本项目模型使用策略

| Issue ID | 任务名称 | 推荐模型 | 理由 |
| :--- | :--- | :--- | :--- |
| VOI-71 | 投注单基础框架与模式切换 | `manus-1.6-lite` | 任务目标明确，属于独立的模块开发，适合使用轻量模型。 |
| VOI-72 | 投注单状态管理与UI展示 | `manus-1.6-lite` | 任务集中在前端状态和UI，复杂度较低。 |
| VOI-73 | 投注生命周期与等待处理 | `manus-1.6-lite` | 涉及有限的状态机和异步处理，lite模型足以胜任。 |
| VOI-74 | 投注拒绝与打回处理 | `manus-1.6-lite` | 逻辑与VOI-73类似，是具体的场景实现。 |
| VOI-75 | 高级过关功能 | `manus-1.6` | 涉及多种过关组合算法和复杂的赔率计算，需要更强的推理能力，适合使用标准模型。 |

✅ **成本优化策略**: 80% 的任务采用 `manus-1.6-lite` 模型，复杂任务 `VOI-75` 采用 `manus-1.6` 模型，不使用 `manus-1.6-max` 模型，实现了成本和效率的最佳平衡。

---

## 工作流程变更说明

### 旧流程（已废弃）
1. 创建功能分支
2. 开发功能
3. 提交代码
4. 创建 Pull Request
5. 代码审查
6. 合并 PR

### 新流程（当前使用）
1. 创建功能分支
2. 开发功能
3. 测试验证
4. 提交代码
5. **直接合并到 main 分支**
6. 更新 Linear Issue 状态

### 优势
- ✅ 加快开发迭代速度
- ✅ 减少等待审核时间
- ✅ 简化工作流程
- ✅ 适合快速原型开发

---

## 常见问题

### Q1: 如果 Agent 遇到问题怎么办？

**A**: 在同一对话中继续沟通，提供更多信息或调整需求。Agent 会根据反馈调整实现。

### Q2: 如何确保任务按依赖顺序执行？

**A**: 
1. 先执行 VOI-71
2. VOI-71 完成并合并后，再执行 VOI-72 和 VOI-75
3. VOI-72 完成后，再执行 VOI-73
4. VOI-73 完成后，再执行 VOI-74

### Q3: 可以同时执行多个任务吗？

**A**: 可以，但需要注意依赖关系：
- VOI-72 和 VOI-75 可以并行（都只依赖 VOI-71）
- VOI-73 和 VOI-74 必须顺序执行

### Q4: 如何验证任务完成质量？

**A**: 
1. 检查 GitHub main 分支的最新提交
2. 本地拉取 main 分支并运行项目
3. 测试功能是否符合验收标准
4. 检查 TypeScript 类型检查是否通过

### Q5: 如果合并后发现问题怎么办？

**A**: 
1. 创建新的对话修复问题
2. 或者使用 `git revert` 回滚提交
3. 修复后重新合并

---

## 进度跟踪

使用以下表格跟踪任务进度：

| Issue ID | 开始时间 | 完成时间 | Commit SHA | 状态 | 备注 |
| :--- | :--- | :--- | :--- | :--- | :--- |
| VOI-71 | - | - | - | 待执行 | - |
| VOI-72 | - | - | - | 待执行 | 等待 VOI-71 |
| VOI-73 | - | - | - | 待执行 | 等待 VOI-71, VOI-72 |
| VOI-74 | - | - | - | 待执行 | 等待 VOI-73 |
| VOI-75 | - | - | - | 待执行 | 等待 VOI-71 |

---

## 相关文档

- [前端产品交互文档](../design/前端产品交互文档.md)
- [AGENT_PROMPTS.md](./AGENT_PROMPTS.md) - 通用提示词库
- [HANDOVER_DOCUMENT.md](./HANDOVER_DOCUMENT.md) - 项目交接文档

---

## 联系方式

如有问题，请在 Linear 或 GitHub 中提出。
